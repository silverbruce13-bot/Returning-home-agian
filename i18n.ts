
import React, { createContext, useState, useContext, useMemo, ReactNode } from 'react';

export type Language = 'ko' | 'en';

export const translations = {
  ko: {
    appName: "주님과 함께하는 묵상일기, 회복과 소망으로",
    appDescription: "바울서신 매일 읽기 및 묵상, 회개와 결단, 전도의 삶을 기록하는 신앙 성장 앱입니다. 제미나이 AI가 당신의 묵상과 전도 계획을 돕습니다.",
    headerSubtitle: "'선한 영' 묵상일기: 주님과 함께 회복과 소망으로",
    headerTitle: "집으로 돌아가는 길 \"귀로\"",
    todaysWord: "오늘의 말씀",
    navReading: "읽기 & 묵상",
    navDiary: "신앙 일기",
    navMission: "전도 & 선교",
    navDashboard: "묵상 대시보드",
    footer: "© {year} 선한영성서당. Powered by Google Gemini.",
    readingFirst: "'읽기 & 묵상' 탭에서 오늘의 말씀을 먼저 읽어주세요.",
    // Dashboard
    dashboardTitle: "{name}님의 영적 여정 대시보드",
    dashboardSubtitle: "주님 안에서 변해가는 소중한 기록들입니다.",
    statsTotalDays: "총 묵상 일수",
    statsCompletionRate: "계획 완료율",
    statsSpiritualStatus: "영적 상태 분포",
    recentMeditations: "최근 묵상 이력",
    noHistoryYet: "아직 완료된 묵상이 없습니다. 말씀을 읽고 묵상을 완료해보세요!",
    epistleProgress: "서신서별 진행도",
    statusGood: "기쁨/충만",
    statusOk: "평안/보통",
    statusBad: "연약/갈급",
    totalRecordCount: "전체 {count}개의 기록",
    spiritualIdentity: "나의 영적 정체성",
    identityLevel1: "말씀의 씨앗을 심는 자",
    identityLevel2: "은혜의 뿌리를 내리는 자",
    identityLevel3: "복음의 열매를 맺는 자",
    identityLevel4: "주님의 신실한 증인",
    // Reading Modes
    modeSequential: "계획대로 읽기",
    modeManual: "말씀 직접 선택",
    selectBook: "서신서 선택",
    selectChapter: "시작 장",
    applySelection: "말씀 열기",
    // Spinner
    loading: "불러오는 중...",
    // BibleReading
    readingPlanTitle: "바울서신 읽기 순서",
    hideButton: "숨기기",
    showAllButton: "전체 순서 보기",
    readingPlanInfo: "바울서신을 매일 2장씩 읽으면 총 {totalDays}일이 소요됩니다. 현재 당신은 {currentDay}일차를 진행 중입니다.",
    meditationRecordGuide: "묵상 기록하기:",
    meditationRecordInstruction: "각 날짜의 묵상 상태를 버튼으로 기록하고 관리해보세요.",
    meditationGood: "녹색: 잘됨",
    meditationOk: "주황색: 보통",
    meditationBad: "빨간색: 못함",
    day: "{day}일차",
    meditationGoodTooltip: "묵상 잘됨",
    meditationOkTooltip: "묵상 보통",
    meditationBadTooltip: "묵상 못함",
    preReadingTitle: "말씀을 열며: 5가지 질문",
    preReadingSubtitle: "다음 질문들을 마음에 품고, 주님의 뜻을 구하며 말씀을 읽어보세요.",
    todaysPassage: "오늘의 말씀",
    todaysSummary: "오늘의 요약",
    copyButton: "공유하기",
    copied: "복사됨!",
    copyFailed: "복사에 실패했습니다. 브라우저 설정을 확인해주세요.",
    loadingPassage: "말씀을 불러오는 중...",
    apiQuotaExceeded: "API 요청 할당량이 초과되었습니다. 나중에 다시 시도해 주세요. 이 메시지가 계속되면 관리자에게 문의하세요.",
    contentError: "콘텐츠를 불러오는 중 오류가 발생했습니다. 네트워크 연결을 확인하고 다시 시도해 주세요.",
    lordsWill: "주님의 뜻 (AI)",
    analyzingIntent: "말씀의 의도를 분석하는 중...",
    meditationGuide: "오늘의 묵상 가이드 (AI)",
    generatingGuide: "묵상 가이드를 생성하는 중...",
    timeAndPlace: "어떤 시간, 어떤 장소",
    generatingBg: "배경 정보를 생성하는 중...",
    generatingBgImage: "배경 이미지를 생성하는 중...",
    biblicalContextAlt: "성경적 배경",
    passageMusicTitle: "오늘의 말씀을 위한 찬양",
    completeMeditation: "오늘의 묵상 완료",
    meditationSaved: "묵상이 기록되었습니다!",
    meditationAlreadySaved: "묵상 완료됨",
    reviewButton: "복습하기",
    archivedMeditationTitle: "{day}일차 묵상 기록",
    manualArchivedTitle: "자유 묵상 기록",
    archiveDate: "기록일: {date}",
    closeButton: "닫기",
    // FaithDiary
    diaryTitle: "나의 신앙 일기",
    repentanceLabel: "회개와 감사",
    repentancePlaceholder: "하나님 앞에서 하루를 돌아보며, 회개할 부분과 감사한 일들을 솔직하게 기록해 보세요.",
    resolveLabel: "결단과 적용",
    resolvePlaceholder: "오늘의 말씀을 삶에 어떻게 적용할지 구체적으로 결단하고 기록해 보세요.",
    dreamLabel: "하나님이 주신 꿈",
    dreamPlaceholder: "말씀과 기도를 통해 하나님께서 보여주시는 비전과 꿈을 기록하고 기도하세요.",
    saveDiaryButton: "일기 저장",
    saved: "저장됨!",
    todaysRecord: "오늘의 기록",
    noRecords: "아직 저장된 기록이 없습니다.",
    noRecordsHint: "일기를 작성하고 '일기 저장' 버튼을 눌러주세요.",
    savedAt: "저장 시간: {time}",
    diaryMusicTitle: "내 마음을 위한 찬양",
    syncingEntries: "기록을 동기화하는 중...",
    // EvangelismMission
    evangelismTraining: "전도 훈련 (AI)",
    generatingTips: "전도 팁을 생성하는 중...",
    tipsFailed: "전도 팁을 불러오는데 실패했습니다.",
    myMissionPlan: "나의 전도와 선교 계획",
    missionPlanPlaceholder: "오늘 만나는 사람들에게 어떻게 하나님의 사랑을 전할지 구체적으로 계획하고 기도하세요.",
    savePlanButton: "계획 저장",
    myRecords: "나의 기록",
    noPlans: "아직 저장된 계획이 없습니다.",
    noPlansHint: "계획을 작성하고 '계획 저장' 버튼을 눌러주세요.",
    syncingPlans: "계획을 동기화하는 중...",
    // MusicRecommendation
    recommendationError: "추천할 만한 찬양을 찾지 못했습니다. 다른 내용으로 시도해 보세요.",
    recommendationApiError: "찬양을 추천하는 중 오류가 발생했습니다.",
    shareFailed: "공유에 실패했습니다.",
    recommendationPrompt: "오늘의 말씀 또는 일기 내용을 바탕으로 찬양을 추천받으세요.",
    recommendationHintDiary: "먼저 일기를 저장해주세요.",
    recommendationHintPassage: "말씀이 로드된 후 시도해주세요.",
    gettingRecommendation: "추천받는 중...",
    getAiRecommendation: "AI 찬양 추천받기",
    aiPickingSongs: "AI가 찬양을 고르는 중...",
    listenOnYoutube: "듣기",
    shareList: "목록 공유",
    // PrayerTraining
    prayerTraining: "기도 훈련 (AI)",
    generatingPrayer: "AI가 기도문을 작성하는 중...",
    prayerApiError: "기도문을 생성하는 중 오류가 발생했습니다.",
    prayerPrompt: "오늘의 말씀을 따라 기도하며 주님과의 교제를 더욱 깊게 나눠보세요.",
    generatePrayerButton: "기도문 생성하기",
    // Sermon Outline
    sermonOutlineTitle: "설교 개요 (AI)",
    generateSermonButton: "설교 개요 생성하기",
    generatingSermon: "AI가 설교 개요를 작성하는 중...",
    sermonApiError: "설교 개요를 생성하는 중 오류가 발생했습니다.",
    sermonPrompt: "오늘의 말씀을 바탕으로 성도들을 위한 실질적인 설교 개요를 작성해 보세요.",
    // Chat
    chatWithAiTitle: "말씀 챗봇 (AI)",
    chatPlaceholder: "궁금한 내용을 입력하세요...",
    sendButton: "전송",
    aiThinking: "답변을 생각 중입니다...",
    // Story Keywords -> Word Keywords
    storyKeywordsTitle: "오늘의 말씀 키워드 (AI)",
    generatingKeywords: "말씀 키워드를 추출하는 중...",
    keywordsApiError: "말씀 키워드 생성에 실패했습니다.",
    positiveMode: "긍정 모드 (사랑, 은혜)",
    sinMode: "적대 모드 (죄, 경고, 회개)",
    hopeMode: "미래 소망 모드 (약속, 구원)",
    // Languages
    korean: "한국어",
    english: "English",
    // Offline/Network
    offlineError: "이 기능을 사용하려면 인터넷 연결이 필요합니다.",
    chatOffline: "챗봇 기능은 온라인 상태에서만 사용할 수 있습니다.",
    // Verse Explanation
    explainSelection: "의미 물어보기",
    explanationModalTitle: "깊이 있는 해설 (AI)",
    selectedTextLabel: "선택한 구절:",
    generatingExplanation: "해설을 생성하는 중입니다...",
    explanationApiError: "해설을 생성하는 중 오류가 발생했습니다.",
    // API Key Screen
    apiKeyRequiredTitle: "API 키 필요",
    apiKeyRequiredMessage: "묵상과 소망의 여정을 시작하려면 Google AI API 키를 선택해 주세요. 이 키는 앱의 AI 기반 기능을 활성화합니다.",
    selectApiKeyButton: "Google AI API 키 선택",
    billingInfoLink: '프로젝트 설정 및 결제 정보는 <a href="https://ai.google.dev/gemini-api/docs/billing" target="_blank" rel="noopener noreferrer" class="underline hover:text-sky-400">Google AI for Developers</a>를 참조하세요.',
    // User Account & Backup
    loginTitle: "묵상 여정 시작하기",
    usernameLabel: "이름 (계정 ID)",
    usernamePlaceholder: "사용하실 이름을 입력하세요",
    startJourney: "시작하기",
    welcomeUser: "{name}님 환영합니다",
    profileTitle: "계정 및 데이터 관리",
    backupTitle: "데이터 백업 (내보내기)",
    backupDesc: "나의 모든 묵상 기록과 데이터를 PC에 파일로 저장합니다.",
    backupButton: "내 컴퓨터에 저장하기",
    restoreTitle: "데이터 복원 (불러오기)",
    restoreDesc: "PC에 저장된 백업 파일을 불러와 데이터를 복원합니다.",
    restoreButton: "파일 선택 및 복원",
    logoutButton: "로그아웃",
    backupSuccess: "데이터 백업이 완료되었습니다.",
    restoreSuccess: "데이터가 성공적으로 복원되었습니다. 페이지를 새로고침합니다.",
    restoreFail: "데이터 복원에 실패했습니다. 올바른 백업 파일인지 확인해주세요.",
    loginRequired: "계정 이름을 입력해주세요.",
    // Enhanced Backup UI
    quickBackup: "빠른 백업",
    dataSafetyTitle: "데이터 안전 보호",
    dataSafetyDesc: "현재 기기에만 저장된 묵상 기록을 파일로 백업하여 안전하게 보호하세요.",
    dataSafetyButton: "지금 백업 파일 생성하기",
    backupReminder: "최근에 백업을 하지 않으셨습니다. 소중한 기록을 위해 백업을 권장합니다.",
    offlineStorageNotice: "이 앱은 개인정보 보호를 위해 서버가 아닌 현재 브라우저에만 데이터를 저장합니다. 기기를 변경하시려면 반드시 백업 파일을 사용해야 합니다.",
  },
  en: {
    appName: "Meditations with the Lord: For Restoration and Hope",
    appDescription: "A faith growth app for daily reading and meditation on the Pauline Epistles, recording a life of repentance, resolution, and evangelism. Gemini AI helps with your meditation and evangelism planning.",
    headerSubtitle: "'Good Spirit' Devotional Diary: With the Lord in Restoration and Hope",
    headerTitle: "The Way Back Home \"Return\"",
    todaysWord: "Today's Word",
    navReading: "Reading & Meditation",
    navDiary: "Faith Diary",
    navMission: "Evangelism & Mission",
    navDashboard: "Meditation Dashboard",
    footer: "© {year} Seonhan Yeongseong Seodang. Powered by Google Gemini.",
    readingFirst: "Please read today's passage first in the 'Reading & Meditation' tab.",
    // Dashboard
    dashboardTitle: "{name}'s Spiritual Journey Dashboard",
    dashboardSubtitle: "Precious records of your transformation in the Lord.",
    statsTotalDays: "Total Meditation Days",
    statsCompletionRate: "Completion Rate",
    statsSpiritualStatus: "Spiritual Status Distribution",
    recentMeditations: "Recent History",
    noHistoryYet: "No completed meditations yet. Start reading and complete your meditation!",
    epistleProgress: "Epistle Progress",
    statusGood: "Joy/Full",
    statusOk: "Peace/Normal",
    statusBad: "Weak/Thirsty",
    totalRecordCount: "Total {count} records",
    spiritualIdentity: "My Spiritual Identity",
    identityLevel1: "Sower of the Word",
    identityLevel2: "Rooted in Grace",
    identityLevel3: "Bearer of Gospel Fruit",
    identityLevel4: "Faithful Witness of the Lord",
    // Reading Modes
    modeSequential: "Follow Plan",
    modeManual: "Select Word",
    selectBook: "Select Epistle",
    selectChapter: "Start Ch.",
    applySelection: "Open Word",
    // Spinner
    loading: "Loading...",
    // BibleReading
    readingPlanTitle: "Pauline Epistles Reading Order",
    hideButton: "Hide",
    showAllButton: "Show Full Order",
    readingPlanInfo: "Reading 2 chapters of the Pauline Epistles daily will take a total of {totalDays} days. You are currently on day {currentDay}.",
    meditationRecordGuide: "Record Your Meditation:",
    meditationRecordInstruction: "Track and manage your meditation status for each day using the buttons.",
    meditationGood: "Green: Good",
    meditationOk: "Orange: Okay",
    meditationBad: "Red: Didn't Do",
    day: "Day {day}",
    meditationGoodTooltip: "Meditation went well",
    meditationOkTooltip: "Meditation was okay",
    meditationBadTooltip: "Didn't meditate",
    preReadingTitle: "Pre-reading Questions",
    preReadingSubtitle: "Reflect on these 5 questions to seek God's will before reading the passage.",
    todaysPassage: "Today's Passage",
    todaysSummary: "Today's Summary",
    copyButton: "Share",
    copied: "Copied!",
    copyFailed: "Failed to copy. Please check your browser settings.",
    loadingPassage: "Loading passage...",
    apiQuotaExceeded: "API request quota has been exceeded. Please try again later. If this message persists, contact the administrator.",
    contentError: "An error occurred while loading content. Please check your network connection and try again.",
    lordsWill: "The Lord's Will (AI)",
    analyzingIntent: "Analyzing the intent of the passage...",
    meditationGuide: "Today's Meditation Guide (AI)",
    generatingGuide: "Generating meditation guide...",
    timeAndPlace: "What Time, What Place",
    generatingBg: "Generating background information...",
    generatingBgImage: "Generating background image...",
    biblicalContextAlt: "Biblical context",
    passageMusicTitle: "Praise for Today's Word",
    completeMeditation: "Complete Today's Meditation",
    meditationSaved: "Meditation Saved!",
    meditationAlreadySaved: "Meditation Completed",
    reviewButton: "Review",
    archivedMeditationTitle: "Archived Meditation for Day {day}",
    manualArchivedTitle: "Free Meditation Record",
    archiveDate: "Date Saved: {date}",
    closeButton: "Close",
    // FaithDiary
    diaryTitle: "My Faith Diary",
    repentanceLabel: "Repentance and Gratitude",
    repentancePlaceholder: "Reflect on your day before God, and honestly record areas for repentance and things you're grateful for.",
    resolveLabel: "Resolution and Application",
    resolvePlaceholder: "Decide specifically how you will apply today's word to your life and write it down.",
    dreamLabel: "God-Given Dream",
    dreamPlaceholder: "Record the vision and dreams God shows you through His word and prayer, and pray over them.",
    saveDiaryButton: "Save Diary",
    saved: "Saved!",
    todaysRecord: "Today's Record",
    noRecords: "No records saved yet.",
    noRecordsHint: "Write in your diary and press the 'Save Diary' button.",
    savedAt: "Saved at: {time}",
    diaryMusicTitle: "Praise for My Heart",
    syncingEntries: "Syncing entries...",
    // EvangelismMission
    evangelismTraining: "Evangelism Training (AI)",
    generatingTips: "Generating evangelism tips...",
    tipsFailed: "Failed to load evangelism tips.",
    myMissionPlan: "My Evangelism and Mission Plan",
    missionPlanPlaceholder: "Plan and pray specifically on how you will share God's love with the people you meet today.",
    savePlanButton: "Save Plan",
    myRecords: "My Records",
    noPlans: "No plans saved yet.",
    noPlansHint: "Write a plan and press the 'Save Plan' button.",
    syncingPlans: "Syncing plans...",
    // MusicRecommendation
    recommendationError: "Couldn't find any suitable songs to recommend. Try with different content.",
    recommendationApiError: "An error occurred while recommending music.",
    shareFailed: "Failed to share.",
    recommendationPrompt: "Get song recommendations based on today's passage or diary entry.",
    recommendationHintDiary: "Please save your diary first.",
    recommendationHintPassage: "Please try after the passage has loaded.",
    gettingRecommendation: "Getting recommendations...",
    getAiRecommendation: "Get AI Song Recommendation",
    aiPickingSongs: "AI is picking songs...",
    listenOnYoutube: "Listen",
    shareList: "Share List",
    // PrayerTraining
    prayerTraining: "Prayer Training (AI)",
    generatingPrayer: "AI is writing a prayer...",
    prayerApiError: "An error occurred while generating the prayer guide.",
    prayerPrompt: "Deepen your fellowship with the Lord by praying according to today's word.",
    generatePrayerButton: "Generate Prayer",
    // Sermon Outline
    sermonOutlineTitle: "Sermon Outline (AI)",
    generateSermonButton: "Generate Sermon Outline",
    generatingSermon: "Generating sermon outline...",
    sermonApiError: "An error occurred while generating the sermon outline.",
    sermonPrompt: "Create a practical sermon outline for your congregation based on today's passage.",
    // Chat
    chatWithAiTitle: "Bible Chatbot (AI)",
    chatPlaceholder: "Type your question here...",
    sendButton: "Send",
    aiThinking: "AI is thinking...",
    // Story Keywords -> Word Keywords
    storyKeywordsTitle: "Today's Word Keywords (AI)",
    generatingKeywords: "Extracting word keywords...",
    keywordsApiError: "Failed to generate word keywords.",
    positiveMode: "Positive Mode (Love, Grace)",
    sinMode: "Hostile Mode (Sin, Warning)",
    hopeMode: "Future Hope Mode (Promise, Salvation)",
    // Languages
    korean: "한국어",
    english: "English",
    // Offline/Network
    offlineError: "An internet connection is required to use this feature.",
    chatOffline: "The chatbot feature is only available when you are online.",
    // Verse Explanation
    explainSelection: "Ask for Meaning",
    explanationModalTitle: "In-Depth Explanation (AI)",
    selectedTextLabel: "Selected Verse:",
    generatingExplanation: "Generating explanation...",
    explanationApiError: "An error occurred while generating the explanation.",
     // API Key Screen
    apiKeyRequiredTitle: "API Key Required",
    apiKeyRequiredMessage: "To begin your journey of meditation and hope, please select a Google AI API key. This key enables the AI-powered features of the app.",
    selectApiKeyButton: "Select Google AI API Key",
    billingInfoLink: 'For information on project setup and billing, please visit <a href="https://ai.google.dev/gemini-api/docs/billing" target="_blank" rel="noopener noreferrer" class="underline hover:text-sky-400">Google AI for Developers</a>.',
    // User Account & Backup
    loginTitle: "Start Your Meditation Journey",
    usernameLabel: "Name (Account ID)",
    usernamePlaceholder: "Enter your name",
    startJourney: "Start Journey",
    welcomeUser: "Welcome, {name}",
    profileTitle: "Account & Data Management",
    backupTitle: "Backup Data (Export)",
    backupDesc: "Save all your meditation records and data to your PC as a file.",
    backupButton: "Save to Computer",
    restoreTitle: "Restore Data (Import)",
    restoreDesc: "Restore data by uploading a backup file from your PC.",
    restoreButton: "Select File & Restore",
    logoutButton: "Logout",
    backupSuccess: "Data backup completed.",
    restoreSuccess: "Data successfully restored. Reloading page.",
    restoreFail: "Failed to restore data. Please check if it's a valid backup file.",
    loginRequired: "Please enter your account name.",
    // Enhanced Backup UI
    quickBackup: "Quick Backup",
    dataSafetyTitle: "Data Safety Guard",
    dataSafetyDesc: "Your data is stored only on this device. Back up to a file to protect your records.",
    dataSafetyButton: "Create Backup File Now",
    backupReminder: "It's been a while since your last backup. We recommend backing up your data.",
    offlineStorageNotice: "For your privacy, this app stores data only in your current browser, not on a server. You MUST use a backup file to move to another device.",
  }
};

type Translations = typeof translations.ko;

interface LanguageContextType {
  language: Language;
  setLanguage: (language: Language) => void;
  t: (key: keyof Translations, vars?: { [key: string]: string | number }) => string;
}

const LanguageContext = createContext<LanguageContextType | undefined>(undefined);

export const LanguageProvider: React.FC<{ children: ReactNode }> = ({ children }) => {
  const [language, setLanguage] = useState<Language>('ko');

  const t = useMemo(() => (key: keyof Translations, vars?: { [key: string]: string | number }) => {
    let text = translations[language][key] || translations['en'][key] || key;
    if (vars) {
      for (const k in vars) {
        text = text.replace(`{${k}}`, String(vars[k]));
      }
    }
    return text;
  }, [language]);

  const value = { language, setLanguage, t };

  return React.createElement(LanguageContext.Provider, { value }, children);
};

export const useLanguage = () => {
  const context = useContext(LanguageContext);
  if (!context) {
    throw new Error('useLanguage must be used within a LanguageProvider');
  }
  return context;
};
